repo,test_patch,problem_statement,FAIL_TO_PASS,PASS_TO_PASS,language
laravel/framework,"diff --git a/tests/Routing/RoutingUrlGeneratorTest.php b/tests/Routing/RoutingUrlGeneratorTest.php
index 9909f9c06392..f200771a5eb0 100755
--- a/tests/Routing/RoutingUrlGeneratorTest.php
+++ b/tests/Routing/RoutingUrlGeneratorTest.php
@@ -734,6 +734,32 @@ public function testPreviousPath()
         $this->assertSame('/bar', $url->previousPath('/bar'));
     }
 
+    public function testWhenPreviousIsEqualToCurrent()
+    {
+        $url = new UrlGenerator(
+            new RouteCollection,
+            Request::create('http://www.foo.com/')
+        );
+
+        $url->getRequest()->headers->set('referer', 'http://www.foo.com/');
+        $this->assertSame('http://www.foo.com', $url->previous());
+        $this->assertSame('http://www.foo.com/bar', $url->previous('/bar'));
+
+        $url->setRequest(Request::create('http://www.foo.com/bar'));
+
+        $url->getRequest()->headers->set('referer', 'http://www.foo.com/bar');
+        $this->assertSame('http://www.foo.com', $url->previous());
+        $this->assertSame('http://www.foo.com/bar', $url->previous('/bar'));
+        $this->assertSame('http://www.foo.com/baz', $url->previous('/baz'));
+
+        $url->setRequest(Request::create('http://www.foo.com/bar?page=2'));
+
+        $url->getRequest()->headers->set('referer', 'http://www.foo.com/bar?page=2');
+        $this->assertSame('http://www.foo.com', $url->previous());
+        $this->assertSame('http://www.foo.com/bar', $url->previous('/bar'));
+        $this->assertSame('http://www.foo.com/bar?page=2', $url->previous('/bar?page=2'));
+    }
+
     public function testRouteNotDefinedException()
     {
         $this->expectException(RouteNotFoundException::class);
","URL::previous() does not use fallback when the previous url matches the current
<!-- DO NOT THROW THIS AWAY -->
<!-- Fill out the FULL versions with patch versions -->

- Laravel Version: 9.52.0
- PHP Version: 8.2.2
- Database Driver & Version: n/a

### Description:

When calling `URL::previous(route('home'))` and the referrer matches the current route I'd expect the fallback to be used.
Currently there is no check for that case though.

### Steps To Reproduce:

```php
// web.php
Route::get('previous-test', fn () => URL::previous('/with-a-fallback'));
```

open the route `/previous-test` in the browser.
expect to see `http://localhost/with-a-fallback` but instead see `http://localhost/previous-test`

<!-- If possible, please provide a GitHub repository to demonstrate your issue -->
<!-- laravel new bug-report --github=""--public"" -->

",['Routing Url Generator > When previous is equal to current'],"['Routing Url Generator > Basic generation', 'Routing Url Generator > Asset generation', 'Routing Url Generator > Basic generation with host formatting', 'Routing Url Generator > Basic generation with request base url with subfolder', 'Routing Url Generator > Basic generation with request base url with subfolder and file suffix', 'Routing Url Generator > Basic generation with request base url with file suffix', 'Routing Url Generator > Basic generation with path formatting', 'Routing Url Generator > Url formatters should receive target route', 'Routing Url Generator > Basic route generation', 'Routing Url Generator > Fluent route name definitions', 'Routing Url Generator > Controller routes with a default namespace', 'Routing Url Generator > Controller routes outside of default namespace', 'Routing Url Generator > Routable interface routing', 'Routing Url Generator > Routable interface routing with custom binding field', 'Routing Url Generator > Routable interface routing as query string', 'Routing Url Generator > Routable interface routing with single parameter', 'Routing Url Generator > Routes maintain request scheme', 'Routing Url Generator > Http only routes', 'Routing Url Generator > Routes with domains', 'Routing Url Generator > Routes with domains and ports', 'Routing Url Generator > Routes with domains strips protocols', 'Routing Url Generator > Https routes with domains', 'Routing Url Generator > Routes with domains through proxy', 'Routing Url Generator > Url generation for controllers requires passing of required parameters with data set #0', 'Routing Url Generator > Url generation for controllers requires passing of required parameters with data set #1', 'Routing Url Generator > Url generation for controllers requires passing of required parameters with data set #2', 'Routing Url Generator > Url generation throws exception for missing parameters with meaningful message with data set ""Missing parameters ""one"", ""two"" and ""three""""', 'Routing Url Generator > Url generation throws exception for missing parameters with meaningful message with data set ""Missing parameters ""two"" and ""three""""', 'Routing Url Generator > Url generation throws exception for missing parameters with meaningful message with data set ""Missing parameters ""one"" and ""three""""', 'Routing Url Generator > Url generation throws exception for missing parameters with meaningful message with data set ""Missing parameters ""one"" and ""two""""', 'Routing Url Generator > Url generation throws exception for missing parameters with meaningful message with data set ""Missing parameter ""three""""', 'Routing Url Generator > Url generation throws exception for missing parameters with meaningful message with data set ""Missing parameter ""two""""', 'Routing Url Generator > Url generation throws exception for missing parameters with meaningful message with data set ""Missing parameter ""one""""', 'Routing Url Generator > Force root url', 'Routing Url Generator > Previous', 'Routing Url Generator > Previous path', 'Routing Url Generator > Route not defined exception', 'Routing Url Generator > Signed url', 'Routing Url Generator > Signed url implicit model binding', 'Routing Url Generator > Signed relative url', 'Routing Url Generator > Signed url parameter cannot be named signature', 'Routing Url Generator > Signed url parameter cannot be named expires', 'Routing Url Generator > Route generation with backed enums', 'Routing Url Generator > Signed url with key resolver']",PHP
