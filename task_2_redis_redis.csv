repo,test_patch,problem_statement,FAIL_TO_PASS,PASS_TO_PASS,language
redis/redis,"diff --git a/tests/unit/type/list.tcl b/tests/unit/type/list.tcl
index 31c8c56bbb0..3981d3f8759 100644
--- a/tests/unit/type/list.tcl
+++ b/tests/unit/type/list.tcl
@@ -496,15 +496,45 @@ start_server {
         assert_error ""*ERR*range*"" {r lpop forbarqaz -123}
     }
 
-    # Make sure we can distinguish between an empty array and a null response
-    r readraw 1
+    proc verify_resp_response {resp response resp2_response resp3_response} {
+        if {$resp == 2} {
+            assert_equal $response $resp2_response
+        } elseif {$resp == 3} {
+            assert_equal $response $resp3_response
+        }
+    }
 
-    test {RPOP/LPOP with the count 0 returns an empty array} {
-        r lpush listcount zero
-        r lpop listcount 0
-    } {*0}
+    foreach resp {3 2} {
+        r hello $resp
 
-    r readraw 0
+        # Make sure we can distinguish between an empty array and a null response
+        r readraw 1
+
+        test ""LPOP/RPOP with the count 0 returns an empty array in RESP$resp"" {
+            r lpush listcount zero
+            assert_equal {*0} [r lpop listcount 0]
+            assert_equal {*0} [r rpop listcount 0]
+        }
+
+        test ""LPOP/RPOP against non existing key in RESP$resp"" {
+            r del non_existing_key
+
+            verify_resp_response $resp [r lpop non_existing_key] {$-1} {_}
+            verify_resp_response $resp [r rpop non_existing_key] {$-1} {_}
+        }
+
+        test ""LPOP/RPOP with <count> against non existing key in RESP$resp"" {
+            r del non_existing_key
+
+            verify_resp_response $resp [r lpop non_existing_key 0] {*-1} {_}
+            verify_resp_response $resp [r lpop non_existing_key 1] {*-1} {_}
+
+            verify_resp_response $resp [r rpop non_existing_key 0] {*-1} {_}
+            verify_resp_response $resp [r rpop non_existing_key 1] {*-1} {_}
+        }
+
+        r readraw 0
+    }
 
     test {Variadic RPUSH/LPUSH} {
         r del mylist
","[BUG] LPOP key [count] returns Null Bulk reply instead of Null array reply.
**Describe the bug**

LPOP with count argument returns Null bulk reply instead of array null reply. As per [documentation](https://redis.io/commands/lpop) 

    When called with the count argument:

    Array reply: list of popped elements, or nil when key does not exist.

When running against Redis 6.2.6, we get

    LPOP NONEXISTINGLIST 10
    $-1

instead of

    ""*-1\r\n""

which is a null array, as documented.

Does the LPOP key [count] always return Bulk Null reply when no list exists to pop from regardless of count is provided or not?

**To reproduce**

Run the command against Redis 6.2.6

LPOP NONEXISTINGLIST 10

**Expected behavior**

>  ""*-1\r\n""

**Additional Information**
[Issue](https://github.com/redis/redis-doc/issues/1734) was first raised in Redis doc.

",['LPOP/RPOP with <count> against non existing key in RESP2'],"['RPOP/LPOP with the optional count argument', 'LPOP/RPOP with the count 0 returns an empty array in RESP3', 'LPOP/RPOP against non existing key in RESP3', 'LPOP/RPOP with <count> against non existing key in RESP3', 'LPOP/RPOP with the count 0 returns an empty array in RESP2', 'LPOP/RPOP against non existing key in RESP2', 'MULTI/EXEC is isolated from the point of view of BLPOP', 'Basic LPOP/RPOP/LMPOP - linkedlist', 'Basic LPOP/RPOP/LMPOP - ziplist', 'LPOP/RPOP/LMPOP against empty list', 'LPOP/RPOP/LMPOP NON-BLOCK or BLOCK against non list value', 'Mass RPOP/LPOP - quicklist']",C
