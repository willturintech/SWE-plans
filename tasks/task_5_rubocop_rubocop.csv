repo,test_patch,problem_statement,FAIL_TO_PASS,PASS_TO_PASS,language
rubocop/rubocop,"diff --git a/spec/rubocop/cop/style/safe_navigation_spec.rb b/spec/rubocop/cop/style/safe_navigation_spec.rb
index 065e978db113..c788afbf5bec 100644
--- a/spec/rubocop/cop/style/safe_navigation_spec.rb
+++ b/spec/rubocop/cop/style/safe_navigation_spec.rb
@@ -1089,7 +1089,13 @@ def foobar
 
             it 'allows an object check followed by 4 chained method calls' do
               expect_no_offenses(<<~RUBY)
-                #{variable} && #{variable}.one.two.three.fore
+                #{variable} && #{variable}.one.two.three.four
+              RUBY
+            end
+
+            it 'allows an object check followed by 4 chained method calls with safe navigation' do
+              expect_no_offenses(<<~RUBY)
+                #{variable} && #{variable}.one.two.three&.four
               RUBY
             end
           end
","Autocorrected safe navigation violates new navigation chain rules
## Expected behavior
Autocorrect should not introduce futher errors. Either autocorrecting now expands safe navigation chains, ignores/encourages object checks, or the offence isn't autocorrectable). 

## Actual behavior
Was getting a warning from rubocop upon updating to 1.68.0 that the navigation chains were too long. Code that was caught: 
```
      foo&.bar&.abc&.xyz&.name
```

I amended this by checking the base object existed before querying fields:

```
      foo & foo.bar.abc&.xyz&.name
```

I re-ran rubocop to find that it found a correctable offence:
```
app/path/to/file.rb:42:7: C: [Corrected] Style/SafeNavigation: Use safe navigation (&.) instead of checking if an object exists before calling the method.
      foo && foo.bar.abx&.xyz&.name
``` 
      
 Updated code after autocorrect reverted it back to the original code that I had with the navigation chain:
```
       foo&.bar&.abc&.xyz&.name
```

Linking the new feature for visibility:
https://github.com/rubocop/rubocop/issues/13171

## Steps to reproduce the problem

Create a block of code where you check for the existance of a base object before chaining.
Run rubocop, it should detect an offence
Run rubocop with --autocorrect-all and it will revert to having a chain that breaches the safe navigation chain length rule.

## RuboCop version

```
jamesoneill@Mac:~/src/my_app(my_branch⚡) » rubocop -v                                                                                     1 ↵
1.68.0
```

",['allows an object check followed by 4 chained method calls with safe navigation'],"['allows a method call as a parameter when the parameter is safe guarded with an object check', 'allows a method call being passed to break safe guarded by an object check', 'allows a method call being passed to fail safe guarded by an object check', 'allows a method call being passed to next safe guarded by an object check', 'allows a method call being passed to raise safe guarded by an object check', 'allows a method call being passed to return safe guarded by an object check', 'allows a method call being passed to throw safe guarded by an object check', 'allows a method call being passed to yield safe guarded by an object check', 'allows a method call safeguarded when using `unless nil?`', 'allows a method call safeguarded with a negative check for the object when using `if`', 'allows a method call safeguarded with a negative check for the object when using `unless`', 'allows a method chain that is used in a comparison safe guarded by an object check', 'allows a negated `and` clause that does not do an object check', 'allows a nil object check followed by a method call', 'allows a nil object check followed by a method call with a block', 'allows a nil object check followed by a method call with params', 'allows a nil object check followed by a method call with params and a block', 'allows a non object check followed by a method call', 'allows a non object check followed by a method call with a block', 'allows a non object check followed by a method call with params', 'allows a non object check followed by a method call with params and a block', 'allows a non-nil object check followed by a method call', 'allows a non-nil object check followed by a method call with a block', 'allows a non-nil object check followed by a method call with params', 'allows a non-nil object check followed by a method call with params and a block', 'allows a single method call inside of a check for the object with an else', 'allows an `and` with a `block` that contains an `and`', 'allows an object check before a blank check', 'allows an object check before a long chain with a block', 'allows an object check before a method call that is used in a comparison', 'allows an object check before a method call that is used in a negated regex comparison', 'allows an object check before a method call that is used in a regex comparison', 'allows an object check before a method call that is used in a spaceship comparison', 'allows an object check before a method call that is used with `empty?`', 'allows an object check before a method chain longer than 2 methods', 'allows an object check before a method chain that is used in a comparison', 'allows an object check before a negated method call with a safe navigation', 'allows an object check before a negated predicate', 'allows an object check before a negated predicate method chain', 'allows an object check before a nil check on a long chain', 'allows an object check before a nil check on a short chain', 'allows an object check before hash access', 'allows an object check followed by 2 chained method calls', 'allows an object check followed by 4 chained method calls', 'allows an object check followed by chained method calls', 'allows an object check followed by chained method calls with blocks', 'allows calls on nil', 'allows calls to methods not safeguarded by respond_to', 'allows calls using safe navigation', 'allows chained method calls during arithmetic operations safe guarded by an object check', 'allows chained method calls during assignment safe guarded by an object check', 'allows enumerable accessor method calls safeguarded by a respond_to check', 'allows for empty if blocks with comments', 'allows for nested `begin`s on the LHS', 'allows method call that is used in a comparison safe guarded by an object check', 'allows method call that is used in a negated regex comparison safe guarded by an object check', 'allows method call that is used in a regex comparison safe guarded by an object check', 'allows method call that is used in a spaceship comparison safe guarded by an object check', 'allows method calls safeguarded by a respond_to check', 'allows method calls safeguarded by a respond_to check on a different variable and method', 'allows method calls safeguarded by a respond_to check on adifferent variable but the same method', 'allows method calls safeguarded by a respond_to check to a different method', 'allows method calls that do not get called using . safe guarded by an object check', 'allows mixed `||` and `&&` inside begin node', 'allows non-convertible ternary expression', 'allows non-object checks', 'allows non-object checks with safe navigation', 'allows object checks in the condition of an elsif statement and a method call on that object in the body', 'corrects an object check followed by a chained method call', 'corrects an object check followed by a chained method call with a block', 'corrects an object check followed by a chained method call with a symbol proc', 'corrects an object check followed by a chained method call with params', 'corrects an object check followed by a method call and another check', 'does not lose comments within if expression', 'does not move comments that are inside an inner block', 'does not register an offense when a method call that nil responds to safe guarded by an object check', 'only moves comments that fall within the expression', 'registers an offense but does not autocorrect when the RHS of `and` is an `or` node containing an `and`', 'registers an offense for a chained method call safeguarded with a check for the object', 'registers an offense for a chained method call safeguarded with a negative nil check for the object', 'registers an offense for a chained method call safeguarded with an unless nil check for the object', 'registers an offense for a check for the object followed by a method call in the condition for an if expression', 'registers an offense for a method call on an accessor safeguarded by a check for the accessed variable', 'registers an offense for a method call safeguarded with a check for the object', 'registers an offense for a method call safeguarded with a negative check for the object', 'registers an offense for a method call safeguarded with a negative nil check for the object', 'registers an offense for a method call safeguarded with a nil check for the object', 'registers an offense for a method call that nil responds to safe guarded by an object check', 'registers an offense for a method call with a block safeguarded with a check for the object', 'registers an offense for a method call with a block safeguarded with a negative check for the object', 'registers an offense for a method call with a block safeguarded with a negative nil check for the object', 'registers an offense for a method call with a block safeguarded with a nil check for the object', 'registers an offense for a method call with params and a block safeguarded with a check for the object', 'registers an offense for a method call with params and a block safeguarded with a negative check for the object', 'registers an offense for a method call with params and a block safeguarded with a negative nil check for the object', 'registers an offense for a method call with params and a block safeguarded with a nil check for the object', 'registers an offense for a method call with params safeguarded with a check for the object', 'registers an offense for a method call with params safeguarded with a negative check for the object', 'registers an offense for a method call with params safeguarded with a negative nil check for the object', 'registers an offense for a method call with params safeguarded with a nil check for the object', 'registers an offense for a non-nil object check followed by a method call', 'registers an offense for a non-nil object check followed by a method call with a block', 'registers an offense for a non-nil object check followed by a method call with params', 'registers an offense for a non-nil object check followed by a method call with params and a block', 'registers an offense for a single method call inside of a check for the object', 'registers an offense for a single method call inside of a non-nil check for the object', 'registers an offense for a single method call inside of an unless negative check for the object', 'registers an offense for a single method call inside of an unless nil check for the object', 'registers an offense for a single method call with a block inside of a check for the object', 'registers an offense for a single method call with a block inside of a non-nil check for the object', 'registers an offense for a single method call with a block inside of an unless negative check for the object', 'registers an offense for a single method call with a block inside of an unless nil check for the object', 'registers an offense for a single method call with params and a block inside of a check for the object', 'registers an offense for a single method call with params and a block inside of a non-nil check for the object', 'registers an offense for a single method call with params and a block inside of an unless negative check for the object', 'registers an offense for a single method call with params and a block inside of an unless nil check for the object', 'registers an offense for a single method call with params inside of a check for the object', 'registers an offense for a single method call with params inside of a non-nil check for the object', 'registers an offense for a single method call with params inside of an unless negative check for the object', 'registers an offense for a single method call with params inside of an unless nil check for the object', 'registers an offense for an object check followed by 1 chained method calls', 'registers an offense for an object check followed by 3 chained method calls', 'registers an offense for an object check followed by a method call', 'registers an offense for an object check followed by a method call on a chained receiver', 'registers an offense for an object check followed by a method call with a block', 'registers an offense for an object check followed by a method call with a comment at EOL', 'registers an offense for an object check followed by a method call with params', 'registers an offense for an object check followed by a method call with params and a block', 'registers an offense for an object check followed by a method calls that nil responds to', 'registers an offense for an object check followed by chained method calls with blocks', 'registers an offense for convertible ternary expressions', 'registers an offense if followed by a different method', 'registers an offense if followed by a different variable', 'registers an offense if preceded by a different method', 'registers an offense if preceded by a different variable', 'registers an offense when safe guard check and safe navigation method call are connected with `&&` condition', 'registers an offense when the RHS of `and` is a nested `and` node', 'registers an offense when the RHS of `and` is an `and` node containing `or`', 'registers and corrects when and clauses contain `begin` nodes', 'registers and corrects when and clauses contain nested `begin` nodes', 'registers and corrects when the and keyword is used', 'registers and corrects when there are multiple clauses that could use safe navigation']",Ruby
